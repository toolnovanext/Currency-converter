<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Currency Converter</title>

    <!-- Embedded CSS with UI/UX Enhancements -->
    <style>
        :root {
            --primary-color: #00b4d8;
            --primary-glow: rgba(0, 180, 216, 0.5);
            --background-start: #1a1a2e;
            --background-end: #16213e;
            --text-color: #e0e0e0;
            --muted-text-color: #9fa8da;
            --container-bg: #1f2847;
            --input-bg: #16213e;
            --white-color: #ffffff;
            --error-color: #ff6b6b;
            --success-color: #00b4d8;
        }

        @keyframes glow {
            0% {
                text-shadow: 0 0 5px var(--primary-glow), 0 0 10px var(--primary-glow), 0 0 20px var(--primary-color);
            }
            100% {
                text-shadow: 0 0 10px var(--primary-glow), 0 0 20px var(--primary-glow), 0 0 40px var(--primary-color);
            }
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, var(--background-start), var(--background-end));
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 1rem;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background: var(--container-bg);
            padding: 2.5rem;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            text-align: center;
            border: 1px solid var(--primary-glow);
        }

        /* 1. Top Header Section */
        .app-header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin: 0;
            color: var(--white-color);
            text-shadow: 0 0 10px var(--primary-glow);
        }

        .app-header .subtitle {
            font-size: 1.1rem;
            margin: 0.5rem 0 1rem;
            color: var(--muted-text-color);
        }

        .app-header .developer-credit {
            font-size: 0.9rem;
            color: var(--muted-text-color);
            font-weight: 500;
            margin: 0;
        }

        /* 2. App Description Section */
        .app-description {
            margin: 2.5rem 0;
            font-size: 1.1rem;
            color: var(--text-color);
        }

        .converter-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .dropdown-wrapper {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* 3. Currency Dropdown Section */
        .custom-dropdown-container {
            text-align: left;
            position: relative;
        }
        
        .custom-dropdown-container label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .custom-dropdown-button {
            width: 100%;
            padding: 1rem;
            min-height: 48px;
            font-size: 1rem;
            background-color: var(--input-bg);
            border: 1px solid var(--muted-text-color);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-align: left;
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .custom-dropdown-button:hover,
        .custom-dropdown-button:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 15px var(--primary-glow);
            outline: none;
        }
        
        .custom-dropdown-list {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            max-height: 250px;
            overflow-y: auto;
            background: var(--background-end);
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            margin-top: 4px;
            list-style: none;
            padding: 0;
            z-index: 10;
            display: none;
        }
        
        .custom-dropdown-list.open { display: block; }
        .custom-dropdown-item:hover, .custom-dropdown-item.focused { background-color: var(--container-bg); }
        .custom-dropdown-item { padding: 0.75rem 1rem; cursor: pointer; transition: background-color 0.2s; }
        .custom-dropdown-item .code { font-weight: bold; font-size: 1rem; color: var(--white-color); }
        .custom-dropdown-item .details { font-size: 0.85rem; color: var(--muted-text-color); }

        /* 4. Amount Input Field */
        .input-group { text-align: left; }
        .input-group label { margin-bottom: 0.5rem; font-weight: 600; display: block; }

        .input-group input[type="number"] {
            font-size: 1.5rem;
            padding: 1rem;
            min-height: 48px;
            border: 1px solid var(--muted-text-color);
            border-radius: 8px;
            width: 100%;
            box-sizing: border-box;
            background-color: var(--input-bg);
            color: var(--white-color);
            transition: all 0.3s ease;
            -moz-appearance: textfield;
        }
        
        .input-group input[type="number"]::-webkit-outer-spin-button,
        .input-group input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

        .input-group input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 15px var(--primary-glow);
        }

        /* 5. Convert Button */
        .convert-button {
            padding: 1rem;
            min-height: 48px;
            font-size: 1.25rem;
            font-weight: 700;
            background: var(--primary-color);
            color: var(--white-color);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 1px;
        }

        .convert-button:hover, .convert-button:focus {
            box-shadow: 0 0 20px 5px var(--primary-glow);
            transform: translateY(-2px);
            outline: none;
        }
        
        .convert-button:active { transform: scale(0.98); }
        
        /* 6. Result Display Section */
        .result-section {
            margin-top: 2rem;
            padding: 1.5rem;
            background-color: var(--input-bg);
            border-radius: 12px;
            min-height: 120px;
            border: 1px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .result-section .converted-amount {
            font-size: 3rem;
            font-weight: 700;
            color: var(--success-color);
            word-wrap: break-word;
            animation: glow 1.5s ease-in-out infinite alternate;
        }

        .result-section .target-currency-name { font-size: 1.2rem; margin-top: 0.5rem; color: var(--text-color); }
        .result-section .timestamp { font-size: 0.9rem; color: var(--muted-text-color); margin-top: 1rem; }
        
        /* 5. Error Handling */
        .error-message {
            color: var(--error-color);
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* 11. Responsiveness */
        @media (min-width: 768px) {
            .dropdown-wrapper { flex-direction: row; }
            .custom-dropdown-container { flex: 1; }
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- Sections 1 & 2 -->
        <header class="app-header">
            <h1><strong>AR Currency Converter</strong></h1>
            <p class="subtitle">Fast and Accessible Currency Conversion Tool</p>
            <p class="developer-credit">Developed by S M Ripon & Arfin Ima â€¢ Powered by Accessible Resource</p>
        </header>
        <p class="app-description">Convert currencies with live, accurate exchange rates. [3]</p>

        <main>
            <form id="converterForm" class="converter-form" onsubmit="event.preventDefault(); handleConversion();">
                <!-- Section 3: Dropdowns -->
                <div class="dropdown-wrapper">
                    <!-- Source Currency -->
                    <div class="custom-dropdown-container">
                        <label for="source-currency-btn">Select Source Country and Currency</label>
                        <button type="button" id="source-currency-btn" class="custom-dropdown-button" aria-haspopup="listbox" aria-expanded="false" aria-labelledby="source-currency-btn"><span class="placeholder">Choose a currency...</span></button>
                        <ul id="source-currency-list" class="custom-dropdown-list" role="listbox" tabindex="-1"></ul>
                    </div>
                    <!-- Target Currency -->
                    <div class="custom-dropdown-container">
                        <label for="target-currency-btn">Select Target Country and Currency</label>
                        <button type="button" id="target-currency-btn" class="custom-dropdown-button" aria-haspopup="listbox" aria-expanded="false" aria-labelledby="target-currency-btn"><span class="placeholder">Choose a currency...</span></button>
                        <ul id="target-currency-list" class="custom-dropdown-list" role="listbox" tabindex="-1"></ul>
                    </div>
                </div>
                <!-- Section 4: Input -->
                <div class="input-group">
                    <label for="amount-input">Enter Amount</label>
                    <input type="number" id="amount-input" value="1" placeholder="Enter amount" required aria-label="Amount to convert" step="any">
                </div>
                <!-- Section 5: Button -->
                <button type="submit" id="convert-btn" class="convert-button" aria-pressed="false">Convert</button>
            </form>
            <!-- Section 6: Result -->
            <div id="result-display" class="result-section" aria-live="polite"></div>
        </main>
    </div>
    
    <!-- JavaScript with Live API and Fixes -->
    <script>
        // --- DATA & STATE ---
        const currencies = [
            { code: 'BDT', name: 'Bangladeshi Taka', country: 'Bangladesh' }, { code: 'INR', name: 'Indian Rupee', country: 'India' }, { code: 'NPR', name: 'Nepalese Rupee', country: 'Nepal' }, { code: 'PKR', name: 'Pakistani Rupee', country: 'Pakistan' }, { code: 'CNY', name: 'Chinese Yuan', country: 'China' }, { code: 'IRR', name: 'Iranian Rial', country: 'Iran' }, { code: 'SAR', name: 'Saudi Riyal', country: 'Saudi Arabia' }, { code: 'USD', name: 'United States Dollar', country: 'United States' }, { code: 'EUR', name: 'Euro', country: 'European Union' }, { code: 'JPY', name: 'Japanese Yen', country: 'Japan' }, { code: 'GBP', name: 'British Pound Sterling', country: 'United Kingdom' }, { code: 'AUD', name: 'Australian Dollar', country: 'Australia' }, { code: 'CAD', name: 'Canadian Dollar', country: 'Canada' }, { code: 'CHF', name: 'Swiss Franc', country: 'Switzerland' }, { code: 'AFN', name: 'Afghan Afghani', country: 'Afghanistan' }, { code: 'ALL', name: 'Albanian Lek', country: 'Albania' }, { code: 'DZD', name: 'Algerian Dinar', country: 'Algeria' }, { code: 'AOA', name: 'Angolan Kwanza', country: 'Angola' }, { code: 'ARS', name: 'Argentine Peso', country: 'Argentina' }, { code: 'AMD', name: 'Armenian Dram', country: 'Armenia' }, { code: 'AWG', name: 'Aruban Florin', country: 'Aruba' }, { code: 'AZN', name: 'Azerbaijani Manat', country: 'Azerbaijan' }, { code: 'BSD', name: 'Bahamian Dollar', country: 'Bahamas' }, { code: 'BHD', name: 'Bahraini Dinar', country: 'Bahrain' }, { code: 'BBD', name: 'Barbadian Dollar', country: 'Barbados' }, { code: 'BYN', name: 'Belarusian Ruble', country: 'Belarus' }, { code: 'BZD', name: 'Belize Dollar', country: 'Belize' }, { code: 'BMD', name: 'Bermudan Dollar', country: 'Bermuda' }, { code: 'BTN', name: 'Bhutanese Ngultrum', country: 'Bhutan' }, { code: 'BOB', name: 'Bolivian Boliviano', country: 'Bolivia' }, { code: 'BAM', name: 'Bosnia-Herzegovina Convertible Mark', country: 'Bosnia and Herzegovina' }, { code: 'BWP', name: 'Botswanan Pula', country: 'Botswana' }, { code: 'BRL', name: 'Brazilian Real', country: 'Brazil' }, { code: 'BND', name: 'Brunei Dollar', country: 'Brunei' }, { code: 'BGN', name: 'Bulgarian Lev', country: 'Bulgaria' }, { code: 'BIF', name: 'Burundian Franc', country: 'Burundi' }, { code: 'CVE', name: 'Cape Verdean Escudo', country: 'Cape Verde' }, { code: 'KHR', name: 'Cambodian Riel', country: 'Cambodia' }, { code: 'KYD', name: 'Cayman Islands Dollar', country: 'Cayman Islands' }, { code: 'CLP', name: 'Chilean Peso', country: 'Chile' }, { code: 'COP', name: 'Colombian Peso', country: 'Colombia' }, { code: 'KMF', name: 'Comorian Franc', country: 'Comoros' }, { code: 'CDF', name: 'Congolese Franc', country: 'Congo, DR' }, { code: 'CRC', name: 'Costa Rican ColÃ³n', country: 'Costa Rica' }, { code: 'HRK', name: 'Croatian Kuna', country: 'Croatia' }, { code: 'CUP', name: 'Cuban Peso', country: 'Cuba' }, { code: 'CZK', name: 'Czech Koruna', country: 'Czech Republic' }, { code: 'DKK', name: 'Danish Krone', country: 'Denmark' }, { code: 'DJF', name: 'Djiboutian Franc', country: 'Djibouti' }, { code: 'DOP', name: 'Dominican Peso', country: 'Dominican Republic' }, { code: 'XCD', name: 'East Caribbean Dollar', country: 'East Caribbean' }, { code: 'EGP', name: 'Egyptian Pound', country: 'Egypt' }, { code: 'ERN', name: 'Eritrean Nakfa', country: 'Eritrea' }, { code: 'ETB', name: 'Ethiopian Birr', country: 'Ethiopia' }, { code: 'FJD', name: 'Fijian Dollar', country: 'Fiji' }, { code: 'GMD', name: 'Gambian Dalasi', country: 'Gambia' }, { code: 'GEL', name: 'Georgian Lari', country: 'Georgia' }, { code: 'GHS', name: 'Ghanaian Cedi', country: 'Ghana' }, { code: 'GTQ', name: 'Guatemalan Quetzal', country: 'Guatemala' }, { code: 'GNF', name: 'Guinean Franc', country: 'Guinea' }, { code: 'GYD', name: 'Guyanaese Dollar', country: 'Guyana' }, { code: 'HTG', name: 'Haitian Gourde', country: 'Haiti' }, { code: 'HNL', name: 'Honduran Lempira', country: 'Honduras' }, { code: 'HKD', name: 'Hong Kong Dollar', country: 'Hong Kong' }, { code: 'HUF', name: 'Hungarian Forint', country: 'Hungary' }, { code: 'ISK', name: 'Icelandic KrÃ³na', country: 'Iceland' }, { code: 'IDR', name: 'Indonesian Rupiah', country: 'Indonesia' }, { code: 'IQD', name: 'Iraqi Dinar', country: 'Iraq' }, { code: 'ILS', name: 'Israeli New Shekel', country: 'Israel' }, { code: 'JMD', name: 'Jamaican Dollar', country: 'Jamaica' }, { code: 'JOD', name: 'Jordanian Dinar', country: 'Jordan' }, { code: 'KZT', name: 'Kazakhstani Tenge', country: 'Kazakhstan' }, { code: 'KES', name: 'Kenyan Shilling', country: 'Kenya' }, { code: 'KWD', name: 'Kuwaiti Dinar', country: 'Kuwait' }, { code: 'KGS', name: 'Kyrgystani Som', country: 'Kyrgyzstan' }, { code: 'LAK', name: 'Laotian Kip', country: 'Laos' }, { code: 'LBP', name: 'Lebanese Pound', country: 'Lebanon' }, { code: 'LRD', name: 'Liberian Dollar', country: 'Liberia' }, { code: 'MGA', name: 'Malagasy Ariary', country: 'Madagascar' }, { code: 'MYR', name: 'Malaysian Ringgit', country: 'Malaysia' }, { code: 'MUR', name: 'Mauritian Rupee', country: 'Mauritius' }, { code: 'MXN', name: 'Mexican Peso', country: 'Mexico' }, { code: 'MDL', name: 'Moldovan Leu', country: 'Moldova' }, { code: 'MNT', name: 'Mongolian Tugrik', country: 'Mongolia' }, { code: 'MAD', name: 'Moroccan Dirham', country: 'Morocco' }, { code: 'MMK', name: 'Myanma Kyat', country: 'Myanmar' }, { code: 'NAD', name: 'Namibian Dollar', country: 'Namibia' }, { code: 'NZD', name: 'New Zealand Dollar', country: 'New Zealand' }, { code: 'NGN', name: 'Nigerian Naira', country: 'Nigeria' }, { code: 'NOK', name: 'Norwegian Krone', country: 'Norway' }, { code: 'OMR', name: 'Omani Rial', country: 'Oman' }, { code: 'PAB', name: 'Panamanian Balboa', country: 'Panama' }, { code: 'PYG', name: 'Paraguayan Guarani', country: 'Paraguay' }, { code: 'PEN', name: 'Peruvian Sol', country: 'Peru' }, { code: 'PHP', name: 'Philippine Peso', country: 'Philippines' }, { code: 'PLN', name: 'Polish Zloty', country: 'Poland' }, { code: 'QAR', name: 'Qatari Rial', country: 'Qatar' }, { code: 'RON', name: 'Romanian Leu', country: 'Romania' }, { code: 'RUB', name: 'Russian Ruble', country: 'Russia' }, { code: 'RWF', 'name': 'Rwandan Franc', 'country': 'Rwanda' }, { code: 'SZL', name: 'Swazi Lilangeni', country: 'Eswatini' }, { code: 'SEK', name: 'Swedish Krona', country: 'Sweden' }, { code: 'TWD', name: 'New Taiwan Dollar', country: 'Taiwan' }, { code: 'THB', name: 'Thai Baht', country: 'Thailand' }, { code: 'TRY', name: 'Turkish Lira', country: 'Turkey' }, { code: 'UAH', name: 'Ukrainian Hryvnia', country: 'Ukraine' }, { code: 'AED', name: 'United Arab Emirates Dirham', country: 'United Arab Emirates' }, { code: 'UYU', name: 'Uruguayan Peso', country: 'Uruguay' }, { code: 'UZS', name: 'Uzbekistan Som', country: 'Uzbekistan' }, { code: 'VND', name: 'Vietnamese Dong', country: 'Vietnam' }, { code: 'ZAR', name: 'South African Rand', country: 'South Africa' }
        ];
        
        // DOM Elements
        const sourceBtn = document.getElementById('source-currency-btn'), targetBtn = document.getElementById('target-currency-btn');
        const sourceList = document.getElementById('source-currency-list'), targetList = document.getElementById('target-currency-list');
        const amountInput = document.getElementById('amount-input'), convertBtn = document.getElementById('convert-btn'), resultDisplay = document.getElementById('result-display');
        
        let selectedSource = null, selectedTarget = null, activeDropdown = null;
        let ratesCache = { timestamp: 0, rates: null };

        // --- Custom Dropdown Logic (Optimized for performance) ---
        function populateDropdowns() {
            const fragment = document.createDocumentFragment();
            currencies.forEach(currency => {
                const item = document.createElement('li');
                item.setAttribute('role', 'option');
                item.setAttribute('tabindex', '-1');
                item.setAttribute('data-code', currency.code);
                item.classList.add('custom-dropdown-item');
                item.innerHTML = `<div class="code">${currency.code}</div><div class="details">${currency.country} â€“ ${currency.name}</div>`;
                fragment.appendChild(item);
            });
            const sourceFragment = fragment.cloneNode(true);
            const targetFragment = fragment.cloneNode(true);
            
            sourceList.appendChild(sourceFragment);
            targetList.appendChild(targetFragment);
            
            sourceList.addEventListener('click', (e) => handleOptionSelect(e, selectedSource, sourceBtn));
            targetList.addEventListener('click', (e) => handleOptionSelect(e, selectedTarget, targetBtn));
        }

        function handleOptionSelect(e, selectionVar, buttonEl) {
            const target = e.target.closest('.custom-dropdown-item');
            if (!target) return;
            const code = target.getAttribute('data-code');
            const currency = currencies.find(c => c.code === code);
            if (currency) {
                if (buttonEl.id === 'source-currency-btn') selectedSource = currency;
                else selectedTarget = currency;
                
                buttonEl.innerHTML = `<span><div class="code">${currency.code}</div><div class="details">${currency.country} â€“ ${currency.name}</div></span>`;
                closeDropdown();
            }
        }
        
        function toggleDropdown(buttonElement) {
            const listElement = buttonElement.nextElementSibling, isExpanded = buttonElement.getAttribute('aria-expanded') === 'true';
            if (activeDropdown && activeDropdown !== listElement) closeDropdown();
            if (isExpanded) closeDropdown();
            else {
                listElement.classList.add('open');
                buttonElement.setAttribute('aria-expanded', 'true');
                listElement.focus();
                activeDropdown = listElement;
            }
        }
        
        function closeDropdown() {
            if (!activeDropdown) return;
            const button = activeDropdown.previousElementSibling;
            activeDropdown.classList.remove('open');
            button.setAttribute('aria-expanded', 'false');
            activeDropdown = null;
        }

        // --- Live Conversion Logic ---
        async function getRates() {
            const now = Date.now();
            // Cache rates for 1 hour to prevent excessive API calls
            if (now - ratesCache.timestamp < 3600000 && ratesCache.rates) {
                return ratesCache.rates;
            }
            // Using ExchangeRate-API's free, no-key endpoint
            const response = await fetch(`https://open.er-api.com/v6/latest/USD`);
            if (!response.ok) throw new Error(`API responded with status: ${response.status}`);
            const data = await response.json();
            if (data.result === 'error') throw new Error(`API Error: ${data['error-type']}`);
            ratesCache = { timestamp: now, rates: data.rates };
            return data.rates;
        }

        async function handleConversion() {
            convertBtn.setAttribute('aria-pressed', 'true');
            resultDisplay.innerHTML = `<div>Calculating...</div>`;
            const amount = parseFloat(amountInput.value);
            
            if (!selectedSource || !selectedTarget || !amount || amount <= 0) {
                displayError("Please select both currencies and enter a valid positive amount.");
                convertBtn.setAttribute('aria-pressed', 'false');
                return;
            }
            
            try {
                if (!navigator.onLine) {
                    throw new Error("You are offline. Please check your internet connection.");
                }
                const rates = await getRates();
                const sourceRate = rates[selectedSource.code];
                const targetRate = rates[selectedTarget.code];

                if (!sourceRate || !targetRate) {
                    throw new Error("Currency data not available. Please try another currency.");
                }

                const convertedAmount = (amount / sourceRate) * targetRate;
                
                displayResult(convertedAmount, selectedTarget);
                speakResult(amount, selectedSource, convertedAmount, selectedTarget);

            } catch (error) {
                console.error("Conversion Error:", error);
                displayError(error.message);
            } finally {
                convertBtn.setAttribute('aria-pressed', 'false');
            }
        }
        
        function displayResult(convertedAmount, targetCurrency) {
            const formatter = new Intl.NumberFormat('en-US', { style: 'decimal', maximumFractionDigits: 2, minimumFractionDigits: 2 });
            const timestamp = new Date().toLocaleString('en-US', { dateStyle: 'long', timeStyle: 'short' });
            
            resultDisplay.innerHTML = `
                <div class="converted-amount" aria-label="Converted amount: ${formatter.format(convertedAmount)}">${formatter.format(convertedAmount)}</div>
                <div class="target-currency-name">${targetCurrency.name}</div>
                <div class="timestamp">Live Rate as of: ${timestamp}</div>
            `;
        }

        function displayError(message) {
            resultDisplay.innerHTML = `<div class="error-message">${message}</div>`;
        }
        
        // --- Accessibility & Feedback ---
        function speakResult(amount, source, convertedAmount, target) {
             if ('speechSynthesis' in window && amount > 0) {
                // Round for cleaner speech
                const roundedConverted = convertedAmount.toFixed(2);
                const textToSpeak = `${amount} ${source.name} is equal to ${roundedConverted} ${target.name}.`;
                const utterance = new SpeechSynthesisUtterance(textToSpeak);
                speechSynthesis.cancel(); // Clear any previous speech
                speechSynthesis.speak(utterance);
             }
        }

        function handleGlobalKeys(e) {
            if (e.key === 'Escape') closeDropdown();
            if (activeDropdown) { // Handle dropdown navigation
                const items = Array.from(activeDropdown.querySelectorAll('[role="option"]'));
                if (items.length === 0) return;
                const currentIndex = items.findIndex(item => item.classList.contains('focused'));
                let nextIndex = -1;

                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    nextIndex = currentIndex < items.length - 1 ? currentIndex + 1 : 0;
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    nextIndex = currentIndex > 0 ? currentIndex - 1 : items.length - 1;
                } else if (e.key === 'Enter' && currentIndex > -1) {
                    e.preventDefault();
                    items[currentIndex].click();
                }

                if (nextIndex !== -1) {
                    items.forEach(item => item.classList.remove('focused'));
                    items[nextIndex].classList.add('focused');
                    items[nextIndex].scrollIntoView({ block: 'nearest' });
                }
            }
        }

        // --- Initial Setup ---
        document.addEventListener('DOMContentLoaded', () => {
            populateDropdowns();
            // Set default selections
            selectedSource = currencies.find(c => c.code === 'USD');
            selectedTarget = currencies.find(c => c.code === 'INR');
            sourceBtn.innerHTML = `<span><div class="code">USD</div><div class="details">United States â€“ United States Dollar</div></span>`;
            targetBtn.innerHTML = `<span><div class="code">INR</div><div class="details">India â€“ Indian Rupee</div></span>`;
            
            // Initial informative text
            resultDisplay.innerHTML = 'Enter an amount and press Convert to see the latest exchange rate.';
        });
        
        sourceBtn.addEventListener('click', () => toggleDropdown(sourceBtn));
        targetBtn.addEventListener('click', () => toggleDropdown(targetBtn));
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.custom-dropdown-container')) closeDropdown();
        });
        document.addEventListener('keydown', handleGlobalKeys);
    </script>
</body>
</html>